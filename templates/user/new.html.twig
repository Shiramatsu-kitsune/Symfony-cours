{% extends 'base.html.twig' %}

{% block title %}Créer un utilisateur{% endblock %}

{% block body %}
<form method="post">
    <!-- Email -->
    <label for="email">Email :</label>
    <input type="email" name="email" id="email" value="{{ email ?? user.email ?? '' }}" required>

    <!-- Pseudonyme -->
    <label for="pseudonyme">Pseudonyme :</label>
    <input type="text" name="pseudonyme" id="pseudonyme" value="{{ pseudonyme ?? user.pseudonyme ?? '' }}" required>

    <!-- Mot de passe -->
    <label for="password">Mot de passe :</label>
    <input type="password" name="password" id="password" required>

    {% if is_granted('ROLE_ADMIN') %}
        <!-- Rôles (uniquement visible pour ADMIN) -->
        <label for="roles">Rôle :</label>
        <select name="roles[]" id="roles" multiple required>
            <option value="ROLE_USER" {% if 'ROLE_USER' in roles %}selected{% endif %}>Utilisateur</option>
            <option value="ROLE_ADMIN" {% if 'ROLE_ADMIN' in roles %}selected{% endif %}>Administrateur</option>
        </select>
    {% endif %}

    <!-- CSRF -->
    <input type="hidden" name="_csrf_token" value="{{ csrf_token('user_creation') }}">

    <button type="submit">Valider</button>

    {% if errors is defined %}
        <ul>
            {% for error in errors %}
                <li style="color:red">{{ error }}</li>
            {% endfor %}
        </ul>
    {% endif %}
</form>
{% endblock %}
